<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Variable Selection or Bayesian Estimation for Differences in Markov Random Fields — bgmCompare • bgms</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Variable Selection or Bayesian Estimation for Differences in Markov Random Fields — bgmCompare"><meta name="description" content="The bgmCompare function estimates the pseudoposterior distribution of
the parameters of a Markov Random Field (MRF) model for mixed binary and ordinal
variables, as well as differences in pairwise interactions and category thresholds
across groups. Groups are assumed to be G independent samples."><meta property="og:description" content="The bgmCompare function estimates the pseudoposterior distribution of
the parameters of a Markov Random Field (MRF) model for mixed binary and ordinal
variables, as well as differences in pairwise interactions and category thresholds
across groups. Groups are assumed to be G independent samples."></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bgms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Bayesian analysis of networks of binary and/or ordinal variables using the bgm function</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayesian-Graphical-Modelling-Lab/bgms/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Variable Selection or Bayesian Estimation for Differences in Markov Random Fields</h1>
      <small class="dont-index">Source: <a href="https://github.com/Bayesian-Graphical-Modelling-Lab/bgms/blob/main/R/bgmCompare.R" class="external-link"><code>R/bgmCompare.R</code></a></small>
      <div class="d-none name"><code>bgmCompare.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>bgmCompare</code> function estimates the pseudoposterior distribution of
the parameters of a Markov Random Field (MRF) model for mixed binary and ordinal
variables, as well as differences in pairwise interactions and category thresholds
across groups. Groups are assumed to be <code>G</code> independent samples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bgmCompare</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">g</span>,</span>
<span>  difference_selection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  main_difference_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Free"</span>, <span class="st">"Collapse"</span>, <span class="st">"Constrain"</span><span class="op">)</span>,</span>
<span>  variable_type <span class="op">=</span> <span class="st">"ordinal"</span>,</span>
<span>  <span class="va">reference_category</span>,</span>
<span>  pairwise_difference_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  main_difference_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pairwise_difference_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bernoulli"</span>, <span class="st">"Beta-Bernoulli"</span><span class="op">)</span>,</span>
<span>  main_difference_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bernoulli"</span>, <span class="st">"Beta-Bernoulli"</span><span class="op">)</span>,</span>
<span>  pairwise_difference_probability <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main_difference_probability <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pairwise_beta_bernoulli_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pairwise_beta_bernoulli_beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  main_beta_bernoulli_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  main_beta_bernoulli_beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  interaction_scale <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  threshold_alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  threshold_beta <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  na_action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"listwise"</span>, <span class="st">"impute"</span><span class="op">)</span>,</span>
<span>  save <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_main <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_pairwise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_indicator <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  display_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Data frame or matrix with binary and ordinal responses. Regular ordinal variables should be coded as integers starting from 0. Missing categories are collapsed for regular ordinal variables but retained for Blume-Capel variables.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A data frame or matrix similar to <code>x</code>, used for two-group designs. <code>x</code> contains Group 1 data, and <code>y</code> contains Group 2 data. Ignored for multi-group designs.</p></dd>


<dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>Group membership vector for rows in <code>x</code>. Required for multi-group designs; ignored if <code>y</code> is provided.</p></dd>


<dt id="arg-difference-selection">difference_selection<a class="anchor" aria-label="anchor" href="#arg-difference-selection"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the function models the inclusion or exclusion of parameter differences. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-main-difference-model">main_difference_model<a class="anchor" aria-label="anchor" href="#arg-main-difference-model"></a></dt>
<dd><p>Character. Specifies how to handle threshold differences when categories are unmatched. Options: <code>"Collapse"</code>, <code>"Free"</code>. The option "Collapse" collapses categories unobserved in one or more groups. The option "Free" option estimates thresholds separately for each group and does not model their difference. Default: <code>"Free"</code>.</p></dd>


<dt id="arg-variable-type">variable_type<a class="anchor" aria-label="anchor" href="#arg-variable-type"></a></dt>
<dd><p>Character or vector. Specifies the type of variables in <code>x</code> (<code>"ordinal"</code> or <code>"blume-capel"</code>). Default: <code>"ordinal"</code>.</p></dd>


<dt id="arg-reference-category">reference_category<a class="anchor" aria-label="anchor" href="#arg-reference-category"></a></dt>
<dd><p>Integer or vector. Reference category for Blume-Capel variables. Required if there is at least one Blume-Capel variable.</p></dd>


<dt id="arg-pairwise-difference-scale">pairwise_difference_scale<a class="anchor" aria-label="anchor" href="#arg-pairwise-difference-scale"></a></dt>
<dd><p>Double. Scale parameter for the Cauchy prior on pairwise differences. Default: <code>1</code>.</p></dd>


<dt id="arg-main-difference-scale">main_difference_scale<a class="anchor" aria-label="anchor" href="#arg-main-difference-scale"></a></dt>
<dd><p>Double. Scale parameter for the Cauchy prior on threshold differences. Default: <code>1</code>.</p></dd>


<dt id="arg-pairwise-difference-prior-main-difference-prior">pairwise_difference_prior, main_difference_prior<a class="anchor" aria-label="anchor" href="#arg-pairwise-difference-prior-main-difference-prior"></a></dt>
<dd><p>Character. Specifies the inclusion probability model (<code>"Bernoulli"</code> or <code>"Beta-Bernoulli"</code>). Default: <code>"Bernoulli"</code>.</p></dd>


<dt id="arg-pairwise-difference-probability">pairwise_difference_probability<a class="anchor" aria-label="anchor" href="#arg-pairwise-difference-probability"></a></dt>
<dd><p>A numeric value or a \(p \times p\) matrix specifying the prior inclusion probability of a pairwise difference in the Bernoulli model. A single value applies the same probability to all pairs, while a matrix allows for edge-specific probabilities. Default: 0.5 for equal prior probability for inclusion and exclusion.</p></dd>


<dt id="arg-main-difference-probability">main_difference_probability<a class="anchor" aria-label="anchor" href="#arg-main-difference-probability"></a></dt>
<dd><p>A numeric value or a length-\(p\) vector specifying the prior inclusion probability of a threshold difference in the Bernoulli model. A single value applies the same probability to all variables, while a vector allows for variable-specific probabilities. Default: 0.5 to indicate no prior preference.</p></dd>


<dt id="arg-pairwise-beta-bernoulli-alpha-pairwise-beta-bernoulli-beta">pairwise_beta_bernoulli_alpha, pairwise_beta_bernoulli_beta<a class="anchor" aria-label="anchor" href="#arg-pairwise-beta-bernoulli-alpha-pairwise-beta-bernoulli-beta"></a></dt>
<dd><p>Double. Shape parameters for the Beta-Bernoulli prior on pairwise differences.</p></dd>


<dt id="arg-main-beta-bernoulli-alpha-main-beta-bernoulli-beta">main_beta_bernoulli_alpha, main_beta_bernoulli_beta<a class="anchor" aria-label="anchor" href="#arg-main-beta-bernoulli-alpha-main-beta-bernoulli-beta"></a></dt>
<dd><p>Double. Shape parameters for the Beta-Bernoulli prior on threshold differences.</p></dd>


<dt id="arg-interaction-scale">interaction_scale<a class="anchor" aria-label="anchor" href="#arg-interaction-scale"></a></dt>
<dd><p>Double. Scale of the Cauchy prior for nuisance pairwise interactions. Default: <code>2.5</code>.</p></dd>


<dt id="arg-threshold-alpha-threshold-beta">threshold_alpha, threshold_beta<a class="anchor" aria-label="anchor" href="#arg-threshold-alpha-threshold-beta"></a></dt>
<dd><p>Double. Shape parameters for the beta-prime prior on nuisance threshold parameters.</p></dd>


<dt id="arg-iter-burnin">iter, burnin<a class="anchor" aria-label="anchor" href="#arg-iter-burnin"></a></dt>
<dd><p>Integer. Number of Gibbs iterations (<code>iter</code>) and burn-in iterations (<code>burnin</code>). Defaults: <code>iter = 1e4</code>, <code>burnin = 1e3</code>.</p></dd>


<dt id="arg-na-action">na_action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>Character. Specifies handling of missing data. <code>"listwise"</code> deletes rows with missing values; <code>"impute"</code> imputes values during Gibbs sampling. Default: <code>"listwise"</code>.</p></dd>


<dt id="arg-save">save<a class="anchor" aria-label="anchor" href="#arg-save"></a></dt>
<dd><p>Logical. If true, sampled states for all parameters are returned. Deprecated.</p></dd>


<dt id="arg-save-main-save-pairwise-save-indicator">save_main, save_pairwise, save_indicator<a class="anchor" aria-label="anchor" href="#arg-save-main-save-pairwise-save-indicator"></a></dt>
<dd><p>Logical. Enable saving sampled states for <code>main_effects</code>, <code>pairwise_effects</code>, and <code>indicator</code>, respectively. Default: <code>FALSE</code>.</p></dd>


<dt id="arg-display-progress">display_progress<a class="anchor" aria-label="anchor" href="#arg-display-progress"></a></dt>
<dd><p>Logical. Show progress bar during computation. Default: <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the posterior means and, optionally, sampled states based on the <code>save_*</code> options. The returned components include:</p><ul><li><p><code>posterior_mean_main</code>, <code>posterior_mean_pairwise</code>, and <code>posterior_mean_indicator</code> for posterior means.</p></li>
<li><p>If saving options are enabled, the list also includes:</p><ul><li><p><code>raw_samples_main</code> – sampled states of main effects.</p></li>
<li><p><code>raw_samples_pairwise</code> – sampled states of pairwise effects.</p></li>
<li><p><code>raw_samples_indicator</code> – sampled states of inclusion indicators.</p></li>
</ul></li>
</ul><p>In addition to the results of the analysis, the output lists some of the
arguments of its call. This is useful for post-processing the results.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function models group differences in Markov Random Fields using a Bayesian
framework. It supports binary and ordinal variables, and includes options for
Bayesian variable selection on the differences in both pairwise interactions
and threshold parameters. Key components are described in the sections below.</p>
    </div>
    <div class="section level2">
    <h2 id="pairwise-interactions">Pairwise Interactions<a class="anchor" aria-label="anchor" href="#pairwise-interactions"></a></h2>


<p>Pairwise interactions between variables <code>i</code> and <code>j</code> are modeled as:
$$\boldsymbol{\theta}_{ij} = \phi_{ij} + \boldsymbol{\delta}_{ij},$$
where:</p>
<ul><li><p>\(\boldsymbol{\theta}_{ij}\) is the vector of pairwise interaction parameters of length <code>G</code>.</p></li>
<li><p>\(\phi_{ij}\) is the overall pairwise interaction (nuisance parameter).</p></li>
<li><p>\(\boldsymbol{\delta}_{ij}\) represents group-specific differences constrained to sum to zero for identification.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="ordinal-variables">Ordinal Variables<a class="anchor" aria-label="anchor" href="#ordinal-variables"></a></h2>


<p>The function supports two types of ordinal variables:</p>
<p><strong>Regular ordinal variables</strong>:
Introduce a threshold parameter for each category except the lowest, modeled as:
$$\boldsymbol{\mu}_{ic} = \tau_{ic} + \boldsymbol{\epsilon}_{ic},$$
where:</p><ul><li><p>\(\tau_{ic}\) denotes an overall effect (nuisance parameter).</p></li>
<li><p>\(\boldsymbol{\epsilon}_{ic}\) represents group-specific differences constrained to sum to zero.</p></li>
</ul><p><strong>Blume-Capel ordinal variables</strong>:
Assume a specific reference category and score responses based on distance to it:
$$\boldsymbol{\mu}_{ic} = (\tau_{i1} + \boldsymbol{\epsilon}_{i1}) \cdot c + (\tau_{i2} + \boldsymbol{\epsilon}_{i2}) \cdot (c - r)^2,$$
where:</p><ul><li><p><code>r</code> is the reference category.</p></li>
<li><p>\(\tau_{i1}\) and \(\tau_{i2}\) are nuisance parameters.</p></li>
<li><p>\(\boldsymbol{\epsilon}_{i1}\) and \(\boldsymbol{\epsilon}_{i2}\) represent group-specific differences.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="variable-selection">Variable Selection<a class="anchor" aria-label="anchor" href="#variable-selection"></a></h2>


<p>Bayesian variable selection enables testing of parameter differences or equivalence across groups. Independent spike-and-slab priors are applied to difference parameters:</p><ul><li><p><strong>Bernoulli Model</strong>: Assigns a fixed probability to parameter inclusion.</p></li>
<li><p><strong>Beta-Bernoulli Model</strong>: Incorporates a beta prior to model inclusion probabilities.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="gibbs-sampling">Gibbs Sampling<a class="anchor" aria-label="anchor" href="#gibbs-sampling"></a></h2>



<p>Parameters are estimated using a Metropolis-within-Gibbs sampling scheme.
When <code>difference_selection = TRUE</code>, the algorithm runs <code>2 * burnin</code> warmup iterations:</p><ul><li><p>First half without difference selection.</p></li>
<li><p>Second half with edge selection enabled.</p></li>
</ul><p>This warmup strategy improves stability of adaptive Metropolis-Hastings proposals and starting values.</p>
    </div>
    <div class="section level2">
    <h2 id="saving-options">Saving Options<a class="anchor" aria-label="anchor" href="#saving-options"></a></h2>


<p>Users can store sampled states for parameters (<code>main_effects</code>, <code>pairwise_effects</code>, <code>indicator</code>) during Gibbs sampling. Enabling these options (<code>save_main</code>, <code>save_pairwise</code>, <code>save_indicator</code>) increases output size and memory usage, so use them judiciously.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Store user par() settings</span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run bgmCompare on the Boredom dataset</span></span></span>
<span class="r-in"><span><span class="co"># For publication-quality results, consider using at least 1e5 iterations</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">bgmCompare</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Boredom</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, g <span class="op">=</span> <span class="va">Boredom</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, iter <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--- INCLUSION VS EDGE DIFFERENCE PLOT -------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">incl_probs</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">posterior_mean_indicator</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">posterior_mean_indicator</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">edge_diffs</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">fit</span><span class="op">$</span><span class="va">posterior_mean_pairwise</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">edge_diffs</span>, <span class="va">incl_probs</span>,</span></span>
<span class="r-in"><span>     pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"gray"</span>, cex <span class="op">=</span> <span class="fl">1.3</span>,</span></span>
<span class="r-in"><span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Posterior Mean Edge Difference"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Posterior Inclusion Probability"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bgmCompare-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--- EVIDENCE PLOT ----------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">prior_odds</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">post_odds</span> <span class="op">&lt;-</span> <span class="va">incl_probs</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">incl_probs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">log_bf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">post_odds</span> <span class="op">/</span> <span class="va">prior_odds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">log_bf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">log_bf</span>, <span class="fl">5</span><span class="op">)</span>  <span class="co"># cap extreme values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">edge_diffs</span>, <span class="va">log_bf</span>,</span></span>
<span class="r-in"><span>     pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"#bfbfbf"</span>, cex <span class="op">=</span> <span class="fl">1.3</span>,</span></span>
<span class="r-in"><span>     axes <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span></span>
<span class="r-in"><span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5.5</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"#bfbfbf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, <span class="st">"Evidence for Exclusion"</span>, pos <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,   <span class="st">"Evidence for Inclusion"</span>, pos <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0</span>,         <span class="st">"Absence of Evidence"</span>, cex <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Log-Inclusion Bayes Factor"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Posterior Mean Interaction Difference"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bgmCompare-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--- MEDIAN PROBABILITY DIFFERENCE NETWORK ----------------------------------</span></span></span>
<span class="r-in"><span><span class="va">median_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">incl_probs</span> <span class="op">&gt;=</span> <span class="fl">0.5</span>, <span class="va">edge_diffs</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Boredom</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">median_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">median_net</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">median_net</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">median_edges</span></span></span>
<span class="r-in"><span><span class="va">median_net</span> <span class="op">&lt;-</span> <span class="va">median_net</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">median_net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">node_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Boredom</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">median_net</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">node_labels</span>, <span class="va">node_labels</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"qgraph"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">qgraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html" class="external-link">qgraph</a></span><span class="op">(</span><span class="va">median_net</span>,</span></span>
<span class="r-in"><span>    theme <span class="op">=</span> <span class="st">"TeamFortress"</span>, maximum <span class="op">=</span> <span class="fl">0.5</span>, fade <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    color <span class="op">=</span> <span class="st">"#f0ae0e"</span>, vsize <span class="op">=</span> <span class="fl">10</span>, repulsion <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>    label.cex <span class="op">=</span> <span class="fl">0.9</span>, label.scale <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    labels <span class="op">=</span> <span class="va">node_labels</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="bgmCompare-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Restore user par() settings</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Maarten Marsman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

