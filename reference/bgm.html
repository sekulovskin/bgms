<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Estimation or Edge Selection for Markov Random Fields — bgm • bgms</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Estimation or Edge Selection for Markov Random Fields — bgm"><meta name="description" content="The bgm function estimates the pseudoposterior distribution of
category thresholds (main effects) and pairwise interaction parameters of a
Markov Random Field (MRF) model for binary and/or ordinal variables.
Optionally, it performs Bayesian edge selection using spike-and-slab
priors to infer the network structure."><meta property="og:description" content="The bgm function estimates the pseudoposterior distribution of
category thresholds (main effects) and pairwise interaction parameters of a
Markov Random Field (MRF) model for binary and/or ordinal variables.
Optionally, it performs Bayesian edge selection using spike-and-slab
priors to infer the network structure."></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bgms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/comparison.html">Model Comparison with bgmCompare</a></li>
    <li><a class="dropdown-item" href="../articles/diagnostics.html">Diagnostics and Spike-and-Slab Summaries</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Getting Started with bgms</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayesian-Graphical-Modelling-Lab/bgms/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Estimation or Edge Selection for Markov Random Fields</h1>
      <small class="dont-index">Source: <a href="https://github.com/Bayesian-Graphical-Modelling-Lab/bgms/blob/main/R/bgm.R" class="external-link"><code>R/bgm.R</code></a></small>
      <div class="d-none name"><code>bgm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>bgm</code> function estimates the pseudoposterior distribution of
category thresholds (main effects) and pairwise interaction parameters of a
Markov Random Field (MRF) model for binary and/or ordinal variables.
Optionally, it performs Bayesian edge selection using spike-and-slab
priors to infer the network structure.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bgm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  variable_type <span class="op">=</span> <span class="st">"ordinal"</span>,</span>
<span>  <span class="va">baseline_category</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  pairwise_scale <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  main_alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main_beta <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  edge_selection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  edge_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bernoulli"</span>, <span class="st">"Beta-Bernoulli"</span>, <span class="st">"Stochastic-Block"</span><span class="op">)</span>,</span>
<span>  inclusion_probability <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  beta_bernoulli_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta_bernoulli_beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta_bernoulli_alpha_between <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta_bernoulli_beta_between <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dirichlet_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  na_action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"listwise"</span>, <span class="st">"impute"</span><span class="op">)</span>,</span>
<span>  update_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nuts"</span>, <span class="st">"adaptive-metropolis"</span>, <span class="st">"hamiltonian-mc"</span><span class="op">)</span>,</span>
<span>  <span class="va">target_accept</span>,</span>
<span>  hmc_num_leapfrogs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  nuts_max_depth <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  learn_mass_matrix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  display_progress <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"per-chain"</span>, <span class="st">"total"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"bgms.verbose"</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="va">interaction_scale</span>,</span>
<span>  <span class="va">burnin</span>,</span>
<span>  <span class="va">save</span>,</span>
<span>  <span class="va">threshold_alpha</span>,</span>
<span>  <span class="va">threshold_beta</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A data frame or matrix with <code>n</code> rows and <code>p</code> columns
containing binary and ordinal responses. Variables are automatically
recoded to non-negative integers (<code>0, 1, ..., m</code>). For regular
ordinal variables, unobserved categories are collapsed; for
Blume–Capel variables, all categories are retained.</p></dd>


<dt id="arg-variable-type">variable_type<a class="anchor" aria-label="anchor" href="#arg-variable-type"></a></dt>
<dd><p>Character or character vector. Specifies the type of
each variable in <code>x</code>. Allowed values: <code>"ordinal"</code> or
<code>"blume-capel"</code>. Binary variables are automatically treated as
<code>"ordinal"</code>. Default: <code>"ordinal"</code>.</p></dd>


<dt id="arg-baseline-category">baseline_category<a class="anchor" aria-label="anchor" href="#arg-baseline-category"></a></dt>
<dd><p>Integer or vector. Baseline category used in
Blume–Capel variables. Can be a single integer (applied to all) or a
vector of length <code>p</code>. Required if at least one variable is of type
<code>"blume-capel"</code>.</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>Integer. Number of post–burn-in iterations (per chain).
Default: <code>1e3</code>.</p></dd>


<dt id="arg-warmup">warmup<a class="anchor" aria-label="anchor" href="#arg-warmup"></a></dt>
<dd><p>Integer. Number of warmup iterations before collecting
samples. A minimum of 1000 iterations is enforced, with a warning if a
smaller value is requested. Default: <code>1e3</code>.</p></dd>


<dt id="arg-pairwise-scale">pairwise_scale<a class="anchor" aria-label="anchor" href="#arg-pairwise-scale"></a></dt>
<dd><p>Double. Scale of the Cauchy prior for pairwise
interaction parameters. Default: <code>2.5</code>.</p></dd>


<dt id="arg-main-alpha-main-beta">main_alpha, main_beta<a class="anchor" aria-label="anchor" href="#arg-main-alpha-main-beta"></a></dt>
<dd><p>Double. Shape parameters of the
beta-prime prior for threshold parameters. Must be positive. If equal,
the prior is symmetric. Defaults: <code>main_alpha = 0.5</code> and
<code>main_beta = 0.5</code>.</p></dd>


<dt id="arg-edge-selection">edge_selection<a class="anchor" aria-label="anchor" href="#arg-edge-selection"></a></dt>
<dd><p>Logical. Whether to perform Bayesian edge selection.
If <code>FALSE</code>, the model estimates all edges. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-edge-prior">edge_prior<a class="anchor" aria-label="anchor" href="#arg-edge-prior"></a></dt>
<dd><p>Character. Specifies the prior for edge inclusion.
Options: <code>"Bernoulli"</code>, <code>"Beta-Bernoulli"</code>, or
<code>"Stochastic-Block"</code>. Default: <code>"Bernoulli"</code>.</p></dd>


<dt id="arg-inclusion-probability">inclusion_probability<a class="anchor" aria-label="anchor" href="#arg-inclusion-probability"></a></dt>
<dd><p>Numeric scalar. Prior inclusion probability
of each edge (used with the Bernoulli prior). Default: <code>0.5</code>.</p></dd>


<dt id="arg-beta-bernoulli-alpha-beta-bernoulli-beta">beta_bernoulli_alpha, beta_bernoulli_beta<a class="anchor" aria-label="anchor" href="#arg-beta-bernoulli-alpha-beta-bernoulli-beta"></a></dt>
<dd><p>Double. Shape parameters
for the beta distribution in the Beta–Bernoulli and the Stochastic-Block
priors. Must be positive. For the Stochastic-Block prior these are the shape
parameters for the within-cluster edge inclusion probabilities.
Defaults: <code>beta_bernoulli_alpha = 1</code> and <code>beta_bernoulli_beta = 1</code>.</p></dd>


<dt id="arg-beta-bernoulli-alpha-between-beta-bernoulli-beta-between">beta_bernoulli_alpha_between, beta_bernoulli_beta_between<a class="anchor" aria-label="anchor" href="#arg-beta-bernoulli-alpha-between-beta-bernoulli-beta-between"></a></dt>
<dd><p>Double.
Shape parameters for the between-cluster edge inclusion probabilities in the
Stochastic-Block prior. Must be positive.
Default: <code>beta_bernoulli_alpha_between = 1</code> and <code>beta_bernoulli_beta_between = 1</code></p></dd>


<dt id="arg-dirichlet-alpha">dirichlet_alpha<a class="anchor" aria-label="anchor" href="#arg-dirichlet-alpha"></a></dt>
<dd><p>Double. Concentration parameter of the Dirichlet
prior on block assignments (used with the Stochastic Block model).
Default: <code>1</code>.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Double. Rate of the zero-truncated Poisson prior on the
number of clusters in the Stochastic Block Model. Default: <code>1</code>.</p></dd>


<dt id="arg-na-action">na_action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>Character. Specifies missing data handling. Either
<code>"listwise"</code> (drop rows with missing values) or <code>"impute"</code>
(perform single imputation during sampling). Default: <code>"listwise"</code>.</p></dd>


<dt id="arg-update-method">update_method<a class="anchor" aria-label="anchor" href="#arg-update-method"></a></dt>
<dd><p>Character. Specifies how the MCMC sampler updates
the model parameters:</p><dl><dt>"adaptive-metropolis"</dt>
<dd><p>Componentwise adaptive Metropolis–Hastings
    with Robbins–Monro proposal adaptation.</p></dd>

  <dt>"hamiltonian-mc"</dt>
<dd><p>Hamiltonian Monte Carlo with fixed path length
    (number of leapfrog steps set by <code>hmc_num_leapfrogs</code>).</p></dd>

  <dt>"nuts"</dt>
<dd><p>The No-U-Turn Sampler, an adaptive form of HMC with
    dynamically chosen trajectory lengths.</p></dd>


</dl><p>Default: <code>"nuts"</code>.</p></dd>


<dt id="arg-target-accept">target_accept<a class="anchor" aria-label="anchor" href="#arg-target-accept"></a></dt>
<dd><p>Numeric between 0 and 1. Target acceptance rate for
the sampler. Defaults are set automatically if not supplied:
<code>0.44</code> for adaptive Metropolis, <code>0.65</code> for HMC,
and <code>0.80</code> for NUTS.</p></dd>


<dt id="arg-hmc-num-leapfrogs">hmc_num_leapfrogs<a class="anchor" aria-label="anchor" href="#arg-hmc-num-leapfrogs"></a></dt>
<dd><p>Integer. Number of leapfrog steps for Hamiltonian
Monte Carlo. Must be positive. Default: <code>100</code>.</p></dd>


<dt id="arg-nuts-max-depth">nuts_max_depth<a class="anchor" aria-label="anchor" href="#arg-nuts-max-depth"></a></dt>
<dd><p>Integer. Maximum tree depth in NUTS. Must be positive.
Default: <code>10</code>.</p></dd>


<dt id="arg-learn-mass-matrix">learn_mass_matrix<a class="anchor" aria-label="anchor" href="#arg-learn-mass-matrix"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, adapt a diagonal mass
matrix during warmup (HMC/NUTS only). If <code>FALSE</code>, use the identity
matrix. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-chains">chains<a class="anchor" aria-label="anchor" href="#arg-chains"></a></dt>
<dd><p>Integer. Number of parallel chains to run. Default: <code>4</code>.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Integer. Number of CPU cores for parallel execution.
Default: <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>.</p></dd>


<dt id="arg-display-progress">display_progress<a class="anchor" aria-label="anchor" href="#arg-display-progress"></a></dt>
<dd><p>Character. Controls progress reporting during
sampling. Options: <code>"per-chain"</code> (separate bar per chain),
<code>"total"</code> (single combined bar), or <code>"none"</code> (no progress).
Default: <code>"per-chain"</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional integer. Random seed for reproducibility. Must be a
single non-negative integer.</p></dd>


<dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the Cauchy prior scale for each
pairwise interaction is adjusted based on the range of response scores.
Variables with more response categories have larger score products
\(x_i \cdot x_j\), which typically correspond to smaller interaction
effects \(\sigma_{ij}\). Without standardization, a fixed prior scale
is relatively wide for these smaller effects, resulting in less shrinkage
for high-category pairs and more shrinkage for low-category pairs.
Standardization scales the prior proportionally to the maximum score
product, ensuring equivalent relative shrinkage across all pairs.
After internal recoding, regular ordinal variables have scores
\(0, 1, \ldots, m\). The adjusted scale for the interaction between
variables \(i\) and \(j\) is <code>pairwise_scale * m_i * m_j</code>,
so that <code>pairwise_scale</code> itself applies to the unit interval case
(binary variables where \(m_i = m_j = 1\)). For Blume-Capel variables
with reference category \(b\), scores are centered as
\(-b, \ldots, m-b\), and the adjustment uses the maximum absolute
product of the score endpoints. For mixed pairs, ordinal variables use
raw score endpoints \((0, m)\) and Blume-Capel variables use centered
score endpoints \((-b, m-b)\).
Default: <code>FALSE</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, prints informational messages
during data processing (e.g., missing data handling, variable recoding).
Defaults to <code>getOption("bgms.verbose", TRUE)</code>. Set
<code>options(bgms.verbose = FALSE)</code> to suppress messages globally.</p></dd>


<dt id="arg-interaction-scale-burnin-save-threshold-alpha-threshold-beta">interaction_scale, burnin, save, threshold_alpha, threshold_beta<a class="anchor" aria-label="anchor" href="#arg-interaction-scale-burnin-save-threshold-alpha-threshold-beta"></a></dt>
<dd><p>`r lifecycle::badge("deprecated")`
Deprecated arguments as of **bgms 0.1.6.0**.
Use `pairwise_scale`, `warmup`, `main_alpha`, and `main_beta` instead.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>"bgms"</code> with posterior summaries, posterior mean
matrices, and access to raw MCMC draws. The object can be passed to
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, and <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>.</p>
<p>Main components include:</p><ul><li><p><code>posterior_summary_main</code>: Data frame with posterior summaries
    (mean, sd, MCSE, ESS, Rhat) for category threshold parameters.</p></li>
<li><p><code>posterior_summary_pairwise</code>: Data frame with posterior
    summaries for pairwise interaction parameters.</p></li>
<li><p><code>posterior_summary_indicator</code>: Data frame with posterior
    summaries for edge inclusion indicators (if <code>edge_selection = TRUE</code>).</p></li>
<li><p><code>posterior_mean_main</code>: Matrix of posterior mean thresholds
    (rows = variables, cols = categories or parameters).</p></li>
<li><p><code>posterior_mean_pairwise</code>: Symmetric matrix of posterior mean
    pairwise interaction strengths.</p></li>
<li><p><code>posterior_mean_indicator</code>: Symmetric matrix of posterior mean
    inclusion probabilities (if edge selection was enabled).</p></li>
<li><p>Additional summaries returned when
    <code>edge_prior = "Stochastic-Block"</code>. For more details about this prior
    see Sekulovski et al. (2025)
.</p><ul><li><p><code>posterior_summary_pairwise_allocations</code>: Data frame with
      posterior summaries (mean, sd, MCSE, ESS, Rhat) for the pairwise
      cluster co-occurrence of the nodes. This serves to indicate
      whether the estimated posterior allocations,co-clustering matrix
      and posterior cluster probabilities (see blow) have converged.</p></li>
<li><p><code>posterior_coclustering_matrix</code>: a symmetric matrix of
      pairwise proportions of occurrence of every variable. This matrix
      can be plotted to visually inspect the estimated number of clusters
      and visually inspect nodes that tend to switch clusters.</p></li>
<li><p><code>posterior_mean_allocations</code>: A vector with the posterior mean
      of the cluster allocations of the nodes. This is calculated using the method
      proposed in Dahl (2009)
.</p></li>
<li><p><code>posterior_mode_allocations</code>: A vector with the posterior
       mode of the cluster allocations of the nodes.</p></li>
<li><p><code>posterior_num_blocks</code>: A data frame with the estimated
      posterior inclusion probabilities for all the possible number of clusters.</p></li>
</ul></li>
<li><p><code>raw_samples</code>: A list of raw MCMC draws per chain:</p><dl><dt><code>main</code></dt>
<dd><p>List of main effect samples.</p></dd>

      <dt><code>pairwise</code></dt>
<dd><p>List of pairwise effect samples.</p></dd>

      <dt><code>indicator</code></dt>
<dd><p>List of indicator samples
        (if edge selection enabled).</p></dd>

      <dt><code>allocations</code></dt>
<dd><p>List of cluster allocations
        (if SBM prior used).</p></dd>

      <dt><code>nchains</code></dt>
<dd><p>Number of chains.</p></dd>

      <dt><code>niter</code></dt>
<dd><p>Number of post–warmup iterations per chain.</p></dd>

      <dt><code>parameter_names</code></dt>
<dd><p>Named lists of parameter labels.</p></dd>


</dl></li>
<li><p><code>arguments</code>: A list of function call arguments and metadata
    (e.g., number of variables, warmup, sampler settings, package version).</p></li>
</ul><p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method prints formatted posterior summaries, and
<code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> extracts posterior mean matrices.</p>
<p>NUTS diagnostics (tree depth, divergences, energy, E-BFMI) are included
in <code>fit$nuts_diag</code> if <code>update_method = "nuts"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function models the joint distribution of binary and ordinal variables
using a Markov Random Field, with support for edge selection through Bayesian
variable selection. The statistical foundation of the model is described in
Marsman et al. (2025)
, where the ordinal
MRF model and its Bayesian estimation procedure were first introduced. While
the implementation in <span class="pkg">bgms</span> has since been extended and updated (e.g.,
alternative priors, parallel chains, HMC/NUTS warmup), it builds on that
original framework.</p>
<p>Key components of the model are described in the sections below.</p>
    </div>
    <div class="section level2">
    <h2 id="ordinal-variables">Ordinal Variables<a class="anchor" aria-label="anchor" href="#ordinal-variables"></a></h2>


<p>The function supports two types of ordinal variables:</p>
<p><strong>Regular ordinal variables</strong>:
Assigns a category threshold parameter to each response category except the
lowest. The model imposes no additional constraints on the distribution of
category responses.</p>
<p><strong>Blume-Capel ordinal variables</strong>:
Assume a baseline category (e.g., a “neutral” response) and score responses
by distance from this baseline. Category thresholds are modeled as:</p>
<p>$$\mu_{c} = \alpha \cdot (c-b) + \beta \cdot (c - b)^2$$</p>
<p>where:</p><ul><li><p>\(\mu_{c}\): category threshold for category \(c\)</p></li>
<li><p>\(\alpha\): linear trend across categories</p></li>
<li><p>\(\beta\): preference toward or away from the baseline</p><ul><li><p>If \(\beta &lt; 0\), the model favors responses near the baseline
     category;</p></li>
<li><p>if \(\beta &gt; 0\), it favors responses farther away (i.e.,
     extremes).</p></li>
</ul></li>
<li><p>\(b\): baseline category</p></li>
</ul><p>Accordingly, pairwise interactions between Blume-Capel variables are modeled
in terms of \(c-b\) scores.</p>
    </div>
    <div class="section level2">
    <h2 id="edge-selection">Edge Selection<a class="anchor" aria-label="anchor" href="#edge-selection"></a></h2>


<p>When <code>edge_selection = TRUE</code>, the function performs Bayesian variable
selection on the pairwise interactions (edges) in the MRF using
spike-and-slab priors.</p>
<p>Supported priors for edge inclusion:</p><ul><li><p><strong>Bernoulli</strong>: Fixed inclusion probability across edges.</p></li>
<li><p><strong>Beta-Bernoulli</strong>: Inclusion probability is assigned a Beta
  prior distribution.</p></li>
<li><p><strong>Stochastic-Block</strong>: Cluster-based edge priors with Beta,
  Dirichlet, and Poisson hyperpriors.</p></li>
</ul><p>All priors operate via binary indicator variables controlling the inclusion
or exclusion of each edge in the MRF.</p>
    </div>
    <div class="section level2">
    <h2 id="prior-distributions">Prior Distributions<a class="anchor" aria-label="anchor" href="#prior-distributions"></a></h2>



<ul><li><p><strong>Pairwise effects</strong>: Modeled with a Cauchy (slab) prior.</p></li>
<li><p><strong>Main effects</strong>: Modeled using a beta-prime
  distribution.</p></li>
<li><p><strong>Edge indicators</strong>: Use either a Bernoulli, Beta-Bernoulli, or
  Stochastic-Block prior (as above).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="sampling-algorithms-and-warmup">Sampling Algorithms and Warmup<a class="anchor" aria-label="anchor" href="#sampling-algorithms-and-warmup"></a></h2>



<p>Parameters are updated within a Gibbs framework, but the conditional
updates can be carried out using different algorithms:</p><ul><li><p><strong>Adaptive Metropolis–Hastings</strong>: Componentwise random–walk
    updates for main effects and pairwise effects. Proposal standard
    deviations are adapted during burn–in via Robbins–Monro updates
    toward a target acceptance rate.</p></li>
<li><p><strong>Hamiltonian Monte Carlo (HMC)</strong>: Joint updates of all
    parameters using fixed–length leapfrog trajectories. Step size is
    tuned during warmup via dual–averaging; the diagonal mass matrix can
    also be adapted if <code>learn_mass_matrix = TRUE</code>.</p></li>
<li><p><strong>No–U–Turn Sampler (NUTS)</strong>: An adaptive extension of HMC
    that dynamically chooses trajectory lengths. Warmup uses a staged
    adaptation schedule (fast–slow–fast) to stabilize step size and, if
    enabled, the mass matrix.</p></li>
</ul><p>When <code>edge_selection = TRUE</code>, updates of edge–inclusion indicators
are carried out with Metropolis–Hastings steps. These are switched on
after the core warmup phase, ensuring that graph updates occur only once
the samplers’ tuning parameters (step size, mass matrix, proposal SDs)
have stabilized.</p>
<p>After warmup, adaptation is disabled. Step size and mass matrix are
fixed at their learned values, and proposal SDs remain constant.</p>
    </div>
    <div class="section level2">
    <h2 id="warmup-and-adaptation">Warmup and Adaptation<a class="anchor" aria-label="anchor" href="#warmup-and-adaptation"></a></h2>



<p>The warmup procedure in <code>bgm</code> uses a multi-stage adaptation
schedule (Stan Development Team 2023)
. Warmup iterations are
split into several phases:</p>
<ul><li><p><strong>Stage 1 (fast adaptation)</strong>: A short initial interval
    where only step size (for HMC/NUTS) is adapted, allowing the chain
    to move quickly toward the typical set.</p></li>
<li><p><strong>Stage 2 (slow windows)</strong>: A sequence of expanding,
    memoryless windows where both step size and, if
    <code>learn_mass_matrix = TRUE</code>, the diagonal mass matrix are
    adapted. Each window ends with a reset of the dual–averaging scheme
    for improved stability.</p></li>
<li><p><strong>Stage 3a (final fast interval)</strong>: A short interval at the
    end of the core warmup where the step size is adapted one final time.</p></li>
<li><p><strong>Stage 3b (proposal–SD tuning)</strong>: Only active when
    <code>edge_selection = TRUE</code> under HMC/NUTS. In this phase,
    Robbins–Monro adaptation of proposal standard deviations is
    performed for the Metropolis steps used in edge–selection moves.</p></li>
<li><p><strong>Stage 3c (graph selection warmup)</strong>: Also only relevant
    when <code>edge_selection = TRUE</code>. At the start of this phase, a
    random graph structure is initialized, and Metropolis–Hastings
    updates for edge inclusion indicators are switched on.</p></li>
</ul><p>When <code>edge_selection = FALSE</code>, the total number of warmup iterations
equals the user–specified <code>burnin</code>. When <code>edge_selection = TRUE</code>
and <code>update_method</code> is <code>"nuts"</code> or <code>"hamiltonian-mc"</code>,
the schedule automatically appends additional Stage-3b and Stage-3c
intervals, so the total warmup is strictly greater than the requested
<code>burnin</code>.</p>
<p>After all warmup phases, the sampler transitions to the sampling phase
with adaptation disabled. Step size and mass matrix (for HMC/NUTS) are
fixed at their learned values, and proposal SDs remain constant.</p>
<p>This staged design improves stability of proposals and ensures that both
local parameters (step size) and global parameters (mass matrix, proposal
SDs) are tuned before collecting posterior samples.</p>
<p>For adaptive Metropolis–Hastings runs, step size and mass matrix
adaptation are not relevant. Proposal SDs are tuned continuously during
burn–in using Robbins–Monro updates, without staged fast/slow intervals.</p>
    </div>
    <div class="section level2">
    <h2 id="missing-data">Missing Data<a class="anchor" aria-label="anchor" href="#missing-data"></a></h2>



<p>If <code>na_action = "listwise"</code>, observations with missing values are
removed.
If <code>na_action = "impute"</code>, missing values are imputed during Gibbs
sampling.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dahl DB (2009).
“Modal clustering in a class of product partition models.”
<em>Bayesian Analysis</em>, <b>4</b>(2), 243–264.
<a href="https://doi.org/10.1214/09-BA409" class="external-link">doi:10.1214/09-BA409</a>
.<br><br> Marsman M, van den Bergh D, Haslbeck JMB (2025).
“Bayesian analysis of the ordinal Markov random field.”
<em>Psychometrika</em>, <b>90</b>(1), 146–182.
<a href="https://doi.org/10.1017/psy.2024.4" class="external-link">doi:10.1017/psy.2024.4</a>
.<br><br> Sekulovski N, Arena G, Haslbeck JMB, Huth KBS, Friel N, Marsman M (2025).
“A Stochastic Block Prior for Clustering in Graphical Models.”
<em>Retrieved from <a href="https://osf.io/preprints/psyarxiv/29p3m_v1" class="external-link">https://osf.io/preprints/psyarxiv/29p3m_v1</a></em>.
OSF preprint.<br><br> Stan Development Team (2023).
<em>Stan Modeling Language Users Guide and Reference Manual</em>.
Version 2.33, <a href="https://mc-stan.org/docs/" class="external-link">https://mc-stan.org/docs/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="../articles/intro.html">vignette("intro", package = "bgms")</a></code> for a worked example.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Run bgm on subset of the Wenchuan dataset</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu">bgm</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Wenchuan</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 7 rows with missing values excluded (n = 355 remaining).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To impute missing values instead, use na_action = "impute".</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 50/2000 (2.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Warmup): ⦗<span style="color: #5FAFAF;">━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 52/2000 (2.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Warmup): ⦗<span style="color: #5FAFAF;">━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 60/2000 (3.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Warmup): ⦗<span style="color: #5FAFAF;">━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 61/2000 (3.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 223/8000 (2.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 2s | ETA: 1m 9s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 100/2000 (5.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Warmup): ⦗<span style="color: #5FAFAF;">━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 161/2000 (8.1%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Warmup): ⦗<span style="color: #5FAFAF;">━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 169/2000 (8.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 192/2000 (9.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 622/8000 (7.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 3s | ETA: 36s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 200/2000 (10.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 280/2000 (14.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 308/2000 (15.4%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 334/2000 (16.7%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 1122/8000 (14.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 4s | ETA: 25s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 300/2000 (15.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 395/2000 (19.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 447/2000 (22.4%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 454/2000 (22.7%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 1596/8000 (20.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 5s | ETA: 20s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 400/2000 (20.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 506/2000 (25.3%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 547/2000 (27.4%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 575/2000 (28.7%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2028/8000 (25.4%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 5s | ETA: 15s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 550/2000 (27.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 683/2000 (34.2%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 740/2000 (37.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 749/2000 (37.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2722/8000 (34.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 6s | ETA: 12s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 700/2000 (35.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 833/2000 (41.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 887/2000 (44.4%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 885/2000 (44.2%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 3305/8000 (41.3%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 7s | ETA: 10s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 850/2000 (42.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━</span>⦘ 945/2000 (47.2%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━</span>⦘ 1011/2000 (50.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━</span>⦘ 1018/2000 (50.9%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━━━</span>⦘ 3824/8000 (47.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 8s | ETA: 9s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━━━━</span>⦘ 950/2000 (47.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━</span>⦘ 1072/2000 (53.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━</span>⦘ 1135/2000 (56.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━</span>⦘ 1133/2000 (56.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Warmup): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━━━━</span>⦘ 4290/8000 (53.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 8s | ETA: 7s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━━━━</span>⦘ 1100/2000 (55.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━</span>⦘ 1211/2000 (60.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━</span>⦘ 1284/2000 (64.2%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━</span>⦘ 1254/2000 (62.7%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━━━━━</span>⦘ 4849/8000 (60.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 9s | ETA: 6s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━━━</span>⦘ 1250/2000 (62.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━</span>⦘ 1329/2000 (66.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━━━━</span>⦘ 1418/2000 (70.9%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━</span>⦘ 1386/2000 (69.3%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━━</span>⦘ 5383/8000 (67.3%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 10s | ETA: 5s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━━━</span>⦘ 1400/2000 (70.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━</span>⦘ 1484/2000 (74.2%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━━━</span>⦘ 1570/2000 (78.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━</span>⦘ 1532/2000 (76.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━━</span>⦘ 5986/8000 (74.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 10s | ETA: 3s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━━━</span>⦘ 1550/2000 (77.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━</span>⦘ 1628/2000 (81.4%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━</span>⦘ 1717/2000 (85.9%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━━</span>⦘ 1672/2000 (83.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━</span>⦘ 6567/8000 (82.1%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 11s | ETA: 2s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━━━</span>⦘ 1650/2000 (82.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━━</span>⦘ 1723/2000 (86.2%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━</span>⦘ 1824/2000 (91.2%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━━</span>⦘ 1771/2000 (88.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━</span>⦘ 6968/8000 (87.1%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 12s | ETA: 2s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━━━</span>⦘ 1750/2000 (87.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺━━━</span>⦘ 1821/2000 (91.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━</span>⦘ 1935/2000 (96.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━</span>⦘ 1876/2000 (93.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━━</span>⦘ 7382/8000 (92.3%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 12s | ETA: 1s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">━━</span>⦘ 1900/2000 (95.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2000/2000 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2000/2000 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2000/2000 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span style="color: #BBBBBB;">╺</span>⦘ 7900/8000 (98.8%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 13s | ETA: 0s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2000/2000 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 2 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2000/2000 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 3 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2000/2000 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 4 (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 2000/2000 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total   (Sampling): ⦗<span style="color: #5FAFAF;">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>⦘ 8000/8000 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed: 13s | ETA: 0s</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Posterior inclusion probabilities</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">indicator</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      mean         sd        mcse n0-&gt;0 n0-&gt;1 n1-&gt;0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-dreams  1.00000 0.00000000          NA     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-flash   1.00000 0.00000000          NA     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-upset   0.95350 0.21056531 0.020634018   177     9     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-physior 0.95300 0.21163884 0.018803391   177    11    11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-flash      1.00000 0.00000000          NA     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-upset      0.99875 0.03533324 0.001674838     4     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-physior    0.06350 0.24386010 0.009061116  3673    72    73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flash-upset       0.06900 0.25345414 0.011206714  3665    59    58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flash-physior     1.00000 0.00000000          NA     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> upset-physior     1.00000 0.00000000          NA     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   n1-&gt;1    n_eff     Rhat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-dreams   3999       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-flash    3999       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-upset    3804 104.1372 1.157488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-physior  3800 126.6830 1.055861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-flash       3999       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-upset       3993 445.0627 1.293320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-physior      181 724.2994 1.015570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flash-upset         217 511.4960 1.068617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flash-physior      3999       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> upset-physior      3999       NA       NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Posterior pairwise effects</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">pairwise</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          mean          sd         mcse     n_eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-dreams  0.631255940 0.001554207 0.0667500309 1844.5267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-flash   0.337831281 0.001385307 0.0618520705 1993.4996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-upset   0.196914526 0.070992831 0.0045237563  246.2808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-physior 0.195512032 0.069395933 0.0041081643  285.3464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-flash      0.501475564 0.001256171 0.0586106935 2176.9877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-upset      0.229125793 0.053452640 0.0015553903 1181.0262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-physior    0.005979916 0.023247067 0.0009544215  593.2748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flash-upset       0.007233699 0.026876728 0.0012391145  470.4678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flash-physior     0.308794047 0.001328681 0.0543685742 1674.3827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> upset-physior     0.707411696 0.001505512 0.0591729274 1544.8201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Rhat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-dreams  1.0001602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-flash   1.0007993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-upset   1.0217084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrusion-physior 1.0109454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-flash      0.9999511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-upset      1.0042391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dreams-physior    1.0066340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flash-upset       1.0169991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flash-physior     1.0061400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> upset-physior     1.0018740</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Maarten Marsman, Don van den Bergh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

  </div></footer></body></html>

