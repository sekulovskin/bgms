<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with bgms • bgms</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with bgms">
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bgms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/comparison.html">Model Comparison with bgmCompare</a></li>
    <li><a class="dropdown-item" href="../articles/diagnostics.html">Diagnostics and Spike-and-Slab Summaries</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Getting Started with bgms</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayesian-Graphical-Modelling-Lab/bgms/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with bgms</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Bayesian-Graphical-Modelling-Lab/bgms/blob/main/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="d-none name"><code>intro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>bgms</strong> package implements Bayesian methods for
analyzing graphical models of binary and ordinal variables. It estimates
main effects (category thresholds) and pairwise interactions in an
ordinal Markov random field (MRF), with optional Bayesian edge selection
via spike–and–slab priors. The package provides two main entry
points:</p>
<ul>
<li>
<code><a href="../reference/bgm.html">bgm()</a></code> for one-sample designs (single network),</li>
<li>
<code><a href="../reference/bgmCompare.html">bgmCompare()</a></code> for independent-sample designs (group
comparisons).</li>
</ul>
<p>This vignette walks through the basic workflow: fitting a model,
summarizing posterior output, and visualizing results.</p>
</div>
<div class="section level2">
<h2 id="wenchuan-dataset">Wenchuan dataset<a class="anchor" aria-label="anchor" href="#wenchuan-dataset"></a>
</h2>
<p>The dataset <code>Wenchuan</code> contains responses from survivors
of the 2008 Wenchuan earthquake on posttraumatic stress items. Here, we
analyze a subset of the first five items as a demonstration.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Bayesian-Graphical-Modelling-Lab.github.io/bgms/" class="external-link">bgms</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyse a subset of the Wenchuan dataset</span></span>
<span><span class="op">?</span><span class="va">Wenchuan</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="va">Wenchuan</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;      intrusion dreams flash upset physior</span></span>
<span><span class="co">#&gt; [1,]         2      2     2     2       3</span></span>
<span><span class="co">#&gt; [2,]         2      2     2     3       3</span></span>
<span><span class="co">#&gt; [3,]         2      4     4     4       3</span></span>
<span><span class="co">#&gt; [4,]         2      1     2     2       1</span></span>
<span><span class="co">#&gt; [5,]         2      2     2     2       2</span></span>
<span><span class="co">#&gt; [6,]         4      3     2     2       2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-a-model">Fitting a model<a class="anchor" aria-label="anchor" href="#fitting-a-model"></a>
</h2>
<p>The main entry point is <code><a href="../reference/bgm.html">bgm()</a></code> for single-group models
and <code><a href="../reference/bgmCompare.html">bgmCompare()</a></code> for multiple-group comparisons.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="../reference/bgm.html">bgm</a></span><span class="op">(</span><span class="va">data</span>, seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<p>Note: During fitting, progress bars are shown in interactive
sessions. In this vignette, they are suppressed for clarity. Sampling
can take a while; the progress bars usually help track progress.</p>
</div>
<div class="section level2">
<h2 id="posterior-summaries">Posterior summaries<a class="anchor" aria-label="anchor" href="#posterior-summaries"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Posterior summaries from Bayesian estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Category thresholds:</span></span>
<span><span class="co">#&gt;                 mean  mcse    sd    n_eff  Rhat</span></span>
<span><span class="co">#&gt; intrusion (1)  0.489 0.006 0.233 1596.771 1.010</span></span>
<span><span class="co">#&gt; intrusion (2) -1.888 0.010 0.340 1053.243 1.024</span></span>
<span><span class="co">#&gt; intrusion (3) -4.828 0.019 0.556  827.554 1.025</span></span>
<span><span class="co">#&gt; intrusion (4) -9.490 0.031 0.897  860.034 1.023</span></span>
<span><span class="co">#&gt; dreams (1)    -0.597 0.005 0.190 1610.037 1.002</span></span>
<span><span class="co">#&gt; dreams (2)    -3.802 0.010 0.341 1174.409 1.003</span></span>
<span><span class="co">#&gt; ... (use `summary(fit)$main` to see full output)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pairwise interactions:</span></span>
<span><span class="co">#&gt;                    mean    sd  mcse    n_eff  Rhat</span></span>
<span><span class="co">#&gt; intrusion-dreams  0.632 0.002 0.064 1716.164 1.000</span></span>
<span><span class="co">#&gt; intrusion-flash   0.338 0.001 0.062 1823.683 1.000</span></span>
<span><span class="co">#&gt; intrusion-upset   0.191 0.076 0.006  165.946 1.033</span></span>
<span><span class="co">#&gt; intrusion-physior 0.198 0.066 0.004  323.018 1.005</span></span>
<span><span class="co">#&gt; dreams-flash      0.498 0.001 0.060 2264.802 1.000</span></span>
<span><span class="co">#&gt; dreams-upset      0.231 0.056 0.002  721.220 1.008</span></span>
<span><span class="co">#&gt; ... (use `summary(fit)$pairwise` to see full output)</span></span>
<span><span class="co">#&gt; Note: NA values are suppressed in the print table. They occur here when an </span></span>
<span><span class="co">#&gt; indicator was zero across all iterations, so mcse/n_eff/Rhat are undefined;</span></span>
<span><span class="co">#&gt; `summary(fit)$pairwise` still contains the NA values.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Inclusion probabilities:</span></span>
<span><span class="co">#&gt;                    mean    sd  mcse n0-&gt;0 n0-&gt;1 n1-&gt;0 n1-&gt;1   n_eff</span></span>
<span><span class="co">#&gt; intrusion-dreams  1.000 0.000           0     0     0  3999        </span></span>
<span><span class="co">#&gt; intrusion-flash   1.000 0.000           0     0     0  3999        </span></span>
<span><span class="co">#&gt; intrusion-upset   0.925 0.263 0.028   287    12    12  3688  88.677</span></span>
<span><span class="co">#&gt; intrusion-physior 0.966 0.182 0.016   129     8     8  3854 124.701</span></span>
<span><span class="co">#&gt; dreams-flash      1.000 0.000           0     0     0  3999        </span></span>
<span><span class="co">#&gt; dreams-upset      0.996 0.063 0.004    14     2     2  3981  267.81</span></span>
<span><span class="co">#&gt;                    Rhat</span></span>
<span><span class="co">#&gt; intrusion-dreams       </span></span>
<span><span class="co">#&gt; intrusion-flash        </span></span>
<span><span class="co">#&gt; intrusion-upset   1.173</span></span>
<span><span class="co">#&gt; intrusion-physior 1.059</span></span>
<span><span class="co">#&gt; dreams-flash           </span></span>
<span><span class="co">#&gt; dreams-upset        1.3</span></span>
<span><span class="co">#&gt; ... (use `summary(fit)$indicator` to see full output)</span></span>
<span><span class="co">#&gt; Note: NA values are suppressed in the print table. They occur when an indicator</span></span>
<span><span class="co">#&gt; was constant (all 0 or all 1) across all iterations, so sd/mcse/n_eff/Rhat</span></span>
<span><span class="co">#&gt; are undefined; `summary(fit)$indicator` still contains the NA values.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Use `summary(fit)$&lt;component&gt;` to access full results.</span></span>
<span><span class="co">#&gt; See the `easybgm` package for other summary and plotting tools.</span></span></code></pre></div>
<p>You can also access posterior means or inclusion probabilities
directly:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; $main</span></span>
<span><span class="co">#&gt;              cat (1)   cat (2)   cat (3)    cat (4)</span></span>
<span><span class="co">#&gt; intrusion  0.4889848 -1.887789 -4.827802  -9.490176</span></span>
<span><span class="co">#&gt; dreams    -0.5974490 -3.801634 -7.133124 -11.578501</span></span>
<span><span class="co">#&gt; flash     -0.1063310 -2.567018 -5.359779  -9.659237</span></span>
<span><span class="co">#&gt; upset      0.4144289 -1.303246 -3.365035  -7.015933</span></span>
<span><span class="co">#&gt; physior   -0.6147997 -3.170385 -6.211313 -10.550982</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pairwise</span></span>
<span><span class="co">#&gt;           intrusion      dreams       flash       upset     physior</span></span>
<span><span class="co">#&gt; intrusion 0.0000000 0.631924323 0.338297975 0.190695963 0.198176315</span></span>
<span><span class="co">#&gt; dreams    0.6319243 0.000000000 0.498040695 0.230776860 0.005254907</span></span>
<span><span class="co">#&gt; flash     0.3382980 0.498040695 0.000000000 0.006462176 0.307138582</span></span>
<span><span class="co">#&gt; upset     0.1906960 0.230776860 0.006462176 0.000000000 0.707867139</span></span>
<span><span class="co">#&gt; physior   0.1981763 0.005254907 0.307138582 0.707867139 0.000000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $indicator</span></span>
<span><span class="co">#&gt;           intrusion  dreams   flash   upset physior</span></span>
<span><span class="co">#&gt; intrusion   0.00000 1.00000 1.00000 0.96575  0.0560</span></span>
<span><span class="co">#&gt; dreams      1.00000 0.00000 0.92525 1.00000  0.0655</span></span>
<span><span class="co">#&gt; flash       1.00000 0.92525 0.00000 0.99600  1.0000</span></span>
<span><span class="co">#&gt; upset       0.96575 1.00000 0.99600 0.00000  1.0000</span></span>
<span><span class="co">#&gt; physior     0.05600 0.06550 1.00000 1.00000  0.0000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="network-plot">Network plot<a class="anchor" aria-label="anchor" href="#network-plot"></a>
</h2>
<p>To visualize the network structure, we threshold the posterior
inclusion probabilities at 0.5 and plot the resulting adjacency
matrix.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">qgraph</span><span class="op">)</span></span>
<span></span>
<span><span class="va">median_probability_network</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">pairwise</span></span>
<span><span class="va">median_probability_network</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">indicator</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html" class="external-link">qgraph</a></span><span class="op">(</span><span class="va">median_probability_network</span>, </span>
<span>       theme <span class="op">=</span> <span class="st">"TeamFortress"</span>, </span>
<span>       maximum <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       fade <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#f0ae0e"</span><span class="op">)</span>, vsize <span class="op">=</span> <span class="fl">10</span>, repulsion <span class="op">=</span> <span class="fl">.9</span>, </span>
<span>       label.cex <span class="op">=</span> <span class="fl">1</span>, label.scale <span class="op">=</span> <span class="st">"FALSE"</span>, </span>
<span>       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<ul>
<li>For comparing groups, see <code><a href="../reference/bgmCompare.html">?bgmCompare</a></code> or the <em>Model
Comparison</em> vignette.</li>
<li>For diagnostics and convergence checks, see the <em>Diagnostics</em>
vignette.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Maarten Marsman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
